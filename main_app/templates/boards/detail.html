{% extends 'base.html' %}

{% block content %}
<section id="boardpage">

  

<div id="board-information">
<!-- board / board user information  -->
<div >
   
    <h1>{{board.title }}</h1>
    <p> {{board.subject }}</p>
    <p>Created by <a href="{% url 'profile_viewer' user.id %}"> {{board.user}} </a> on {{board.date}} </p>
    {% if board.user == request.user %}
        <a href="{% url 'board_update' board.id %}">Edit</a>
        <a href="{% url 'board_delete' board.id %}">Delete</a>
     {% endif %}
    
</div> 

  <!-- Add New Image -->
<div>
    <h5><a id='pin-images'class="btn-floating btn-large waves-effect waves-light teal"><i class="material-icons"> +</i></a> &nbsp; Upload Image</h5>
    <div class="boardform-overlay">
        <div id="board-add-image">
            <form  id='boardform' method="post" action="{% url 'add_image' board.id %}" enctype="multipart/form-data">
                {% csrf_token %}
                <table>
                {{ image_form.as_table }}
                </table>
                <input type="submit" value="Add Image" class="btn">
            <button id= "cancel" class="btn" >cancel</button>
            </form>
        </div>
    </div>
<div>

 <!-- Images Available to Add  -->
   {% if board.user == request.user %}
   <button class="open">Available Images</button>
       <div class="popup-overlay"> 
               <div class="popup-content"> 
                    <div class='board-container'>
                       {% if image.count %}
       
                       {% for image in image.all %}
                       <div class='available-section'>
                    
                         <img class="img" id="board-images-add" height='250px' width='250px'src='/media/{{image.img}}'/>
                        
                       <div class="unassoc-image">
                               <form action="{% url 'assoc_image' board.id image.id %}" method="post">
                                   {% csrf_token %}
                                   <button id= "add-image" type="submit" >+</button>
                               </form>
   
                       </div>
   
                    </div>
                       {% endfor %}
                       {% endif %}
                       
                   </div>
                   <button class="close">Close</button>
                </div>
       </div> 
    {% endif %} 
</div>

<!-- board images  -->

 <div class='board-container'>

        {% if board.images.count %}
        {% for image in board.images.all %}
    
     <div class='board-section'>

        <img class="img" id="board-images" src='/media/{{image.img}}'/>
        
            
        <div class="unassoc-image">
            <form action="{% url 'unassoc_image' board.id image.id %}" method="post">
                 {% csrf_token %}
                {% if board.user == request.user %}
                <button id= "remove-image" type="submit" >X</button>
            </form>
                {% endif %}
        </div>
    </div>
        {% endfor %}
        {% endif %}

    </div>
            
 </div>

<div>
 

</section>



 
<!--JS CODE -->

<script>
$('.open').on("click", function() {
$(".popup-overlay, .popup-content").addClass('active');
});

//removes the "active" class to .popup and .popup-content when the "Close" button is clicked 
$(".close, .popup-overlay").on("click", function() {
$(".popup-overlay, .popup-content").removeClass('active');
});

$('#pin-images').on("click", function() {
console.log('clicked')
$("#board-add-image, .boardform-overlay ").addClass('active');
});

$('#cancel').on("click", function() {
console.log('clicked')
$("#board-add-image, .boardform-overlay").removeClass('active');
});

$('main').attr('class', 'boarddetail');

</script>

{% endblock %}
